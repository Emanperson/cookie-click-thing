<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
  <link href="style.css" rel="stylesheet" />
  <script>
// General game setup
var cookieamount = 0;
var clickamount = 1;

// var developer = "1";
const infobox = document.getElementById("info");

// Buy amounts
var minibuyamount = "15";
var ovenbuyamount = 100;
var grandmotherbuyamount = 10000;
// debug
var devbuild = "0";

console.log("1.4.0 release");
document.getElementById("grandmotherbuy").hidden = true;



// should be built in but whatever
function sleep(ms) {
  return new Promise((resolve) => setTimeout(resolve, ms));
}
// sleep(ms).then(() => { });
function getRandomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

//
// info box management
// infoAPI lmao
function info(infocommand) {
  if (infocommand == "clear") {
    infobox.innerHTML = "";
  } else if (infocommand == "notenuough") {
    infobox.innerHTML = "<p>Not enough Cookies!</p>";
  } else {
    infobox.innerHTML = "<p>" + infocommand + "</p>";
  }
}
// To Be Phased out in favor of infoAPI
function notenuough() {
  infobox.innerHTML = "<p>Not enough Cookies!</p>";
}
function clear() {
  infobox.innerHTML = ""; // Clear the info box
}

//
// Core FUnctions
//

// THE BUTTON
function addcookie() {
try{
    played = 1;
    cookieamount += clickamount;
    refresh_amounts();
    clear();
    
  } catch (error) {   console.error(error);document.getElementById("errorlog").innerHTML= error;
    crash("COOKIE_CLICK_FAILED");
  }
}
// THE function
function refresh_amounts() {
  try {
    if (gameloaded === 1) {
    document.getElementById("amount").innerHTML = cookieamount + " Cookies" + "<br>" + clickamount + " per click";
    } else {
      info("Game Loading, please wait")
    }
  } catch (error) {   console.error(error);document.getElementById("errorlog").innerHTML= error;
    crash("AMOUNT_REFRESH_FAILED");
  }
}

//
// Purchases :3
//

function buyminiclick() {
  try {
    clear();
    if (cookieamount >= minibuyamount) {
      cookieamount = cookieamount - minibuyamount;
      clickamount += 1;
      refresh_amounts();
      minibuyamount = Number(minibuyamount) + 5;
      document.getElementById("miniclickbuy").innerHTML =
        "Mini Mouse™ (+1 per click) | " + minibuyamount + " Cookies";
    } else {
      notenuough();
    }
  } catch (error) {   console.error(error);document.getElementById("errorlog").innerHTML= error;
    crash("PURCHASE_FAULT");
  }
}

function buyoven() {
  try {
    clear();

    if (cookieamount >= ovenbuyamount) {
      cookieamount -= ovenbuyamount;
      clickamount += 20;
      refresh_amounts();
      ovenbuyamount = Number(ovenbuyamount) * 2;
      document.getElementById("ovenbuy").innerHTML =
        "Oven (+20 per click) | " + ovenbuyamount + " Cookies";
      unlockgrandma();
    } else {
      notenuough();
    }
  } catch (error) {   console.error(error);document.getElementById("errorlog").innerHTML= error;
    crash("PURCHASE_FAULT");
  }
}
function unlockgrandma() {
  document.getElementById("grandmotherbuy").hidden = false;
}

function buygrandmother() {
  try {
    clear();

    if (cookieamount >= grandmotherbuyamount) {
      cookieamount = cookieamount - grandmotherbuyamount;
      clickamount += 100;
      refresh_amounts();
      grandmotherbuyamount = grandmotherbuyamount * 2;
      document.getElementById("grandmotherbuy").innerHTML =
        "Someone's grandmother (+100 per click) | " +
        grandmotherbuyamount +
        " Cookies";
    } else {
      notenuough();
    }
  } catch (error) {   console.error(error);document.getElementById("errorlog").innerHTML= error;
    crash("PURCHASE_FAULT");
  }
}

// cheats
function devmode() {
  console.log("chea- i mean dev mode activated");
  cheat();
}
function cheat() {
  try {
    if (devbuild == 1) {
      document.querySelector("#dev").innerHTML =
        "<input id='devcooks' type='number'></input>" +
        "<br>" +
        "<button onclick='devcook()'>Jesse, we need to cook</button>" +
        "<br>";
    } else {
      crash("CHEATS_DETECTED");
    }
  } catch (error) {   console.error(error);document.getElementById("errorlog").innerHTML= error;
    crash("CHEATS_FAILED");
  }
}

function devcook() {
  let deviscookin = parseInt(document.getElementById("devcooks").value, 10);
  if (isNaN(deviscookin)) {
    crash("BAD_CHEATS");
  } else {
    cookieamount += deviscookin;
    refresh_amounts();
  }
}

//
//ERROR HANDLE :3
//
function crash(failreason) {
  document.getElementById("bsod").hidden = false;
  document.getElementById("game").remove();
  console.error("CRASHED!");
  console.error(failreason);
  if (failreason == undefined) {
  } else {
    document.getElementById("dbug").innerHTML = failreason;
  }
  document.querySelector("html").style.background = "#0074d0";
  if (devbuild == 1) {
    document.querySelector("html").style.background = "#41FF00";
  }
  
}

// Made by emanperson0 :3
    </script>
  <title>Cookie Clicker</title>
  <link rel="icon" type="image/x-icon" href="http://emanperson.github.io/cookie-click-thing/favicon/mainicon.png"/>
</head>
<body id="body">
  <div id="game">
    <div id="header">
      <header>v1.4.0 | Web Version <br> Probably broken; use the <a href=https://sites.google.com/jsd117.org/cookieclicker">Google sites</a> version.</header>
   
    </div>
    <br>

    <button id="button" onclick="addcookie()">
      <img class="img" src="https://i.imgur.com/kxzy2VO.png" alt="Click for cookies">
    </button>
    <br>

    <!-- Info Display -->
    <div id="info"></div>

    <p id="amount">0 Cookies <br> 1 per click</p>
    <br>

    <div id="upgrades" class="glass">
      <button id="miniclickbuy" onclick="buyminiclick()">Mini Mouse™ (+1 per click) | 15 Cookies</button>
      <br>
      <button id="ovenbuy" onclick="buyoven()">Oven (+20 per click) | 100 Cookies</button>
      <br>
      <button id="grandmotherbuy" onclick="buygrandmother()">Someone's grandmother (+100 per click) | 10,000 Cookies</button>
      <br>
    </div>

    <br>
    <br>
    <br>
    <button onclick="cheat()">Just Cheat</button>
    <div id="dev"></div>
  </div>
<div id="bsod" hidden>
  <h1 id="frown"> :(</h1>
  <p class="text-main">Game Crashed</p>
  <br>
  <p class="text-main">What failed:
  <p id="dbug" class="text-main">GENERIC_CRASH</p>
  <p id="errorlog"></p>
  </p>
  <br>
  <br>
  <br>
  <br>
  <img id="qr" src="https://i.postimg.cc/JzDqG87j/frame-1.png"></img>
  <p class="text-main"> For Support, scan this QR code</p>
</div>
</body>
<!-- Made by emanperson0 :3 -->
</html>
